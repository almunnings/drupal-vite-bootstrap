var k=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function E(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var g={},x={get exports(){return g},set exports(p){g=p}};(function(p,r){(function(l,u){p.exports=u()})(k,function(){return function(i){var l={};function u(n){if(l[n])return l[n].exports;var e=l[n]={i:n,l:!1,exports:{}};return i[n].call(e.exports,e,e.exports,u),e.l=!0,e.exports}return u.m=i,u.c=l,u.d=function(n,e,s){u.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:s})},u.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(e,"a",e),e},u.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},u.p="",u(u.s=0)}([function(i,l,u){var n=u(1),e=s(n);function s(d){return d&&d.__esModule?d:{default:d}}i.exports=e.default},function(i,l,u){Object.defineProperty(l,"__esModule",{value:!0});var n=function(){function c(a,o){for(var f=0;f<o.length;f++){var y=o[f];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(a,y.key,y)}}return function(a,o,f){return o&&c(a.prototype,o),f&&c(a,f),a}}(),e=u(2),s=b(e),d=u(3),t=b(d),h=u(4);function b(c){return c&&c.__esModule?c:{default:c}}function v(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function")}var m={tab:9,enter:13,esc:27,space:32},_=function(){function c(a,o){v(this,c);var f={buttonSelector:".js-submenu-expand",submenuSelector:".js-submenu",stylingClass:"js-submenu-expanded",applyAriaCurrent:!0,closeOnTabOut:!0,focusFirstLink:!0,onClose:null,onOpen:null};this.options=(0,t.default)(f,o,!0),this.dom={el:a,button:a.querySelector(this.options.buttonSelector),submenu:a.querySelector(this.options.submenuSelector)},a&&this.dom.button&&this.dom.submenu&&(this.build(),this.bindEvents())}return n(c,[{key:"build",value:function(){this.id=this.dom.submenu.id||this.generateUniqueID(),this.dom.button.getAttribute("aria-expanded")||this.dom.button.setAttribute("aria-expanded",!1),this.dom.submenu.id||(this.dom.submenu.id=this.id),this.dom.submenu.role="navigation"}},{key:"bindEvents",value:function(){var o=this;this.dom.button.addEventListener("click",this.handleExpandClick.bind(this)),this.dom.button.addEventListener("keyup",function(f){f.keyCode===m.space&&o.toggleOpenClose()}),document.addEventListener("keyup",function(f){f.keyCode===m.esc&&o.isExpanded()&&(o.close(),o.dom.button.focus())})}},{key:"handleBlur",value:function(o){o.keyCode===m.tab&&(0,h.closest)(""+this.options.submenuSelector,document.activeElement)!==this.dom.submenu&&this.close()}},{key:"handleExpandClick",value:function(o){o.stopPropagation(),o.preventDefault(),this.toggleOpenClose()}},{key:"toggleOpenClose",value:function(){this.isExpanded()?this.close():this.open()}},{key:"open",value:function(){if(this.dom.button.setAttribute("aria-expanded",!0),this.dom.button.setAttribute("aria-controls",this.id),this.options.focusFirstLink){var o=this.dom.submenu.querySelector("a");o&&o.focus()}this.dom.el.classList.add(this.options.stylingClass),this.options.closeOnTabOut&&document.addEventListener("keyup",this.handleBlur.bind(this)),typeof this.options.onOpen=="function"&&this.options.onOpen(this)}},{key:"close",value:function(){this.dom.button.setAttribute("aria-expanded",!1),this.dom.button.removeAttribute("aria-controls"),this.dom.el.classList.remove(this.options.stylingClass),this.options.closeOnTabOut&&document.removeEventListener("keyup",this.handleBlur.bind(this)),typeof this.options.onClose=="function"&&this.options.onClose(this)}},{key:"generateUniqueID",value:function(){var o="js-submenu-"+(0,s.default)(6,0);return document.getElementById(o)&&(o=this.generateUniqueID()),o}},{key:"isExpanded",value:function(){return this.dom.button.getAttribute("aria-expanded")==="true"}},{key:"destroy",value:function(){}}]),c}();l.default=_},function(i,l,u){(function(){var n=function(b,h){var d=["abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ","0123456789","~!@#$%^&()_+-={}[];',"],t="",h=h||"aA0";h.split("").forEach(function(m){isNaN(parseInt(m))?/[a-z]/.test(m)?t+=d[0]:/[A-Z]/.test(m)?t+=d[1]:t+=d[3]:t+=d[2]});for(var b=b||30,v="";b--;)v+=t.charAt(Math.floor(Math.random()*t.length));return v};i.exports=n})()},function(i,l,u){Object.defineProperty(l,"__esModule",{value:!0});var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};l.default=function(e,s,d){var t,h;for(t in s)h=e[t]!==void 0,h&&n(s[t])==="object"&&s[t]!==null&&s[t].nodeName===void 0?isDate(s[t])?d&&(e[t]=new Date(s[t].getTime())):isArray(s[t])?d&&(e[t]=s[t].slice(0)):e[t]=extend({},s[t],d):(d||!h)&&(e[t]=s[t]);return e}},function(i,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.closest=n;function n(e,s){var d=document.querySelectorAll(e),t=void 0;do for(t=d.length;--t>=0&&d.item(t)!==s;);while(t<0&&(s=s.parentElement));return s}}])})})(x);const T=E(g);class S{constructor(){this.menuElement=document.querySelector(".region-primary-menu .nav"),this.menuElement&&([...this.menuElement.children].forEach(i=>{new T(i,{}),this.bindTouch(i.querySelector(":scope > a"))}),this.bindTouchWindow())}bindTouchWindow(){document.addEventListener("touchstart",r=>{const i=this.elementTouchedLink(r.target,0),l=this.elementTouchedDropdown(r.target,0),u=this.menuElement.querySelectorAll('[data-double-tap="true"]');l||[...u].forEach(n=>{n!==i&&(n.dataset.doubleTap=!1)})})}bindTouch(r){r.parentNode.querySelectorAll(".js-submenu").length&&r.addEventListener("touchend",i=>{this.doubleTapped(i)||i.preventDefault()})}doubleTapped(r){const i=r.currentTarget;return i.dataset.doubleTap?!0:(i.dataset.doubleTap=!0,!1)}elementTouchedLink(r,i){var l;if(i<5){if((l=r==null?void 0:r.dataset)!=null&&l.doubleTap)return r;if(r.parentNode)return this.elementTouchedLink(r.parentNode,i+1)}return!1}elementTouchedDropdown(r,i){if(i<10){if(r.classList&&r.classList.contains("js-submenu"))return r;if(r.parentNode)return this.elementTouchedDropdown(r.parentNode,i+1)}return!1}}export{S as default};
